<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>flekspy &mdash; flekspy  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="flekspy.amrex" href="amrex/index.html" />
    <link rel="prev" title="API Reference" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            flekspy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../idl_data.html">FLEKS Python Visualization Toolkit: IDL Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../amrex_data.html">FLEKS Python Visualization Toolkit: AMReX Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test_particle_data.html">FLEKS Python Visualization Toolkit: Test Particle Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithm.html">Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conduct.html">Code of Conduct</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">flekspy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="amrex/index.html">flekspy.amrex</a></li>
<li class="toctree-l4"><a class="reference internal" href="flekspy/index.html">flekspy.flekspy</a></li>
<li class="toctree-l4"><a class="reference internal" href="idl/index.html">flekspy.idl</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot/index.html">flekspy.plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="tp/index.html">flekspy.tp</a></li>
<li class="toctree-l4"><a class="reference internal" href="util/index.html">flekspy.util</a></li>
<li class="toctree-l4"><a class="reference internal" href="yt/index.html">flekspy.yt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flekspy.read_idl"><code class="docutils literal notranslate"><span class="pre">read_idl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flekspy.IDLAccessor"><code class="docutils literal notranslate"><span class="pre">IDLAccessor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flekspy.YtFLEKSData"><code class="docutils literal notranslate"><span class="pre">YtFLEKSData</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flekspy.extract_phase"><code class="docutils literal notranslate"><span class="pre">extract_phase()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flekspy.FLEKSTP"><code class="docutils literal notranslate"><span class="pre">FLEKSTP</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flekspy.AMReXParticleData"><code class="docutils literal notranslate"><span class="pre">AMReXParticleData</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#flekspy.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../BATSRUSReader/index.html">BATSRUSReader</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">flekspy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">API Reference</a></li>
      <li class="breadcrumb-item active">flekspy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/autoapi/flekspy/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-flekspy">
<span id="flekspy"></span><h1>flekspy<a class="headerlink" href="#module-flekspy" title="Link to this heading"></a></h1>
<p>flekspy Public API.</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="amrex/index.html">flekspy.amrex</a></li>
<li class="toctree-l1"><a class="reference internal" href="flekspy/index.html">flekspy.flekspy</a></li>
<li class="toctree-l1"><a class="reference internal" href="idl/index.html">flekspy.idl</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot/index.html">flekspy.plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="tp/index.html">flekspy.tp</a></li>
<li class="toctree-l1"><a class="reference internal" href="util/index.html">flekspy.util</a></li>
<li class="toctree-l1"><a class="reference internal" href="yt/index.html">flekspy.yt</a></li>
</ul>
</div>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#flekspy.IDLAccessor" title="flekspy.IDLAccessor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IDLAccessor</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#flekspy.YtFLEKSData" title="flekspy.YtFLEKSData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">YtFLEKSData</span></code></a></p></td>
<td><p>Read and plot the AMReX format output from FLEKS.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#flekspy.FLEKSTP" title="flekspy.FLEKSTP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FLEKSTP</span></code></a></p></td>
<td><p>A class that is used to read and plot test particles. Each particle ID consists of</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#flekspy.AMReXParticleData" title="flekspy.AMReXParticleData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AMReXParticleData</span></code></a></p></td>
<td><p>This class provides an interface to the particle data in a plotfile.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#flekspy.read_idl" title="flekspy.read_idl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_idl</span></code></a>(filename)</p></td>
<td><p>Read IDL format file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#flekspy.extract_phase" title="flekspy.extract_phase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extract_phase</span></code></a>(pp)</p></td>
<td><p>Extract phase space distribution from PhasePlot object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#flekspy.load" title="flekspy.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(filename[, iDomain, iSpecies, iFile, ...])</p></td>
<td><p>Load FLEKS data.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="flekspy.read_idl">
<span class="sig-prename descclassname"><span class="pre">flekspy.</span></span><span class="sig-name descname"><span class="pre">read_idl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/idl/idl.html#read_idl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.read_idl" title="Link to this definition"></a></dt>
<dd><p>Read IDL format file.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flekspy.IDLAccessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flekspy.</span></span><span class="sig-name descname"><span class="pre">IDLAccessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarray_obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/idl/idl.html#IDLAccessor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.IDLAccessor" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.IDLAccessor._obj">
<span class="sig-name descname"><span class="pre">_obj</span></span><a class="headerlink" href="#flekspy.IDLAccessor._obj" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.IDLAccessor.get_slice">
<span class="sig-name descname"><span class="pre">get_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_loc</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">xarray.Dataset</span></span></span><a class="reference internal" href="../../_modules/flekspy/idl/idl.html#IDLAccessor.get_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.IDLAccessor.get_slice" title="Link to this definition"></a></dt>
<dd><p>Get a 2D slice from the 3D IDL data.
:param norm: The normal direction of the slice from “x”, “y” or “z”
:type norm: str
:param cur_loc: The position of slicing.
:type cur_loc: float</p>
<p>Return: xarray.Dataset</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flekspy.</span></span><span class="sig-name descname"><span class="pre">YtFLEKSData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_field_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cparam_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fparam_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boxlib_native'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mks'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">yt.frontends.boxlib.api.BoxlibDataset</span></code></p>
<p>Read and plot the AMReX format output from FLEKS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output_dir</strong> (<em>str</em>) – the path to the data.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">flekspy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">flekspy</span><span class="o">.</span><span class="n">YtFLEKSData</span><span class="p">(</span><span class="s2">&quot;3d_particle*n00004750_amrex&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData._index_class">
<span class="sig-name descname"><span class="pre">_index_class</span></span><a class="headerlink" href="#flekspy.YtFLEKSData._index_class" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData._field_info_class">
<span class="sig-name descname"><span class="pre">_field_info_class</span></span><a class="headerlink" href="#flekspy.YtFLEKSData._field_info_class" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.default_fluid_type">
<span class="sig-name descname"><span class="pre">default_fluid_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mesh'</span></em><a class="headerlink" href="#flekspy.YtFLEKSData.default_fluid_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.default_field">
<span class="sig-name descname"><span class="pre">default_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('mesh',</span> <span class="pre">'density')</span></em><a class="headerlink" href="#flekspy.YtFLEKSData.default_field" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.fluid_types">
<span class="sig-name descname"><span class="pre">fluid_types</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('mesh',</span> <span class="pre">'index',</span> <span class="pre">'raw')</span></em><a class="headerlink" href="#flekspy.YtFLEKSData.fluid_types" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.read_field_data">
<span class="sig-name descname"><span class="pre">read_field_data</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#flekspy.YtFLEKSData.read_field_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData._parse_parameter_file">
<span class="sig-name descname"><span class="pre">_parse_parameter_file</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData._parse_parameter_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData._parse_parameter_file" title="Link to this definition"></a></dt>
<dd><p>Parses the parameter file and establishes the various
dictionaries.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData._set_code_unit_attributes">
<span class="sig-name descname"><span class="pre">_set_code_unit_attributes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData._set_code_unit_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData._set_code_unit_attributes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.pvar">
<span class="sig-name descname"><span class="pre">pvar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData.pvar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData.pvar" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.get_slice">
<span class="sig-name descname"><span class="pre">get_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_loc</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="util/index.html#flekspy.util.DataContainer2D" title="flekspy.util.DataContainer2D"><span class="pre">flekspy.util.DataContainer2D</span></a></span></span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData.get_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData.get_slice" title="Link to this definition"></a></dt>
<dd><p>Returns a DataContainer2D object that contains a slice along the normal direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>norm</strong> (<em>str</em>) – slice normal direction in “x”, “y” or “z”</p></li>
<li><p><strong>cut_loc</strong> (<em>float</em>) – cut location along the normal direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="util/index.html#flekspy.util.DataContainer3D" title="flekspy.util.DataContainer3D"><span class="pre">flekspy.util.DataContainer3D</span></a></span></span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData.get_domain" title="Link to this definition"></a></dt>
<dd><p>Read all the simulation data into a 3D box.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.plot_slice">
<span class="sig-name descname"><span class="pre">plot_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'planet'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData.plot_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData.plot_slice" title="Link to this definition"></a></dt>
<dd><p>Plot 2D slice</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>norm</strong> – str
Normal direction of the slice in “x”, “y” or “z”.</p></li>
<li><p><strong>cut_loc</strong> – float
The location of the slice.</p></li>
<li><p><strong>vars</strong> – a list or string of plotting variables.
Example: “Bx rhos0” or [“Bx”, “rhos0”]</p></li>
</ul>
</dd>
</dl>
<p>unit_type: The unit system of the plots. “planet” or “si”.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rhos0&quot;</span><span class="p">,</span> <span class="s2">&quot;uzs0&quot;</span><span class="p">,</span> <span class="s2">&quot;Bz&quot;</span><span class="p">,</span> <span class="s2">&quot;pxxs1&quot;</span><span class="p">,</span> <span class="s2">&quot;Ex&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="nb">vars</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splt</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData._get_profile">
<span class="sig-name descname"><span class="pre">_get_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">yt.data_objects.selection_objects.data_selection_objects.YTSelectionContainer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData._get_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData._get_profile" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.get_phase">
<span class="sig-name descname"><span class="pre">get_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">yt.data_objects.selection_objects.data_selection_objects.YTSelectionContainer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData.get_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData.get_phase" title="Link to this definition"></a></dt>
<dd><p>Get particle phase space distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>region</strong> – YTSelectionContainer
Spatial region to be selected, such as all_data, box, region, or sphere.</p></li>
<li><p><strong>y_field</strong> (<em>x_field &amp;</em>) – string
The x-/y- axes, from “p_ux”, “p_uy”, “p_uz”, “p_x”, “p_y” or “p_z”.</p></li>
<li><p><strong>z_field</strong> – string
It is usually the particle weight: “p_w”.</p></li>
<li><p><strong>domain_size</strong> – tuple
Axis range of 4 elements: x_min, x_max, y_min, y_max</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get_phase</span><span class="p">(</span><span class="s2">&quot;p_ux&quot;</span><span class="p">,</span> <span class="s2">&quot;p_uy&quot;</span><span class="p">,</span> <span class="s2">&quot;p_w&quot;</span><span class="p">,</span> <span class="n">domain_size</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.plot_phase">
<span class="sig-name descname"><span class="pre">plot_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">yt.data_objects.selection_objects.data_selection_objects.YTSelectionContainer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'planet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">customized</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">yt.visualization.profile_plotter.PhasePlot</span></span></span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData.plot_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData.plot_phase" title="Link to this definition"></a></dt>
<dd><p>Plot particle phase space distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>region</strong> – YTSelectionContainer
Spatial region to be selected, such as all_data, box, region, or sphere.</p></li>
<li><p><strong>y_field</strong> (<em>x_field &amp;</em>) – string
The x-/y- axes, from “p_ux”, “p_uy”, “p_uz”, “p_x”, “p_y” or “p_z”.</p></li>
<li><p><strong>z_field</strong> – string
It is usually the particle weight: “p_w”.</p></li>
<li><p><strong>unit_type</strong> – string
The unit system of the plots. “planet” or “si”.</p></li>
<li><p><strong>domain_size</strong> – tuple
Axis range of 4 elements: x_min, x_max, y_min, y_max</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">plot_phase</span><span class="p">(</span><span class="s2">&quot;p_ux&quot;</span><span class="p">,</span> <span class="s2">&quot;p_uy&quot;</span><span class="p">,</span> <span class="s2">&quot;p_w&quot;</span><span class="p">,</span> <span class="n">domain_size</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.YtFLEKSData.plot_particles">
<span class="sig-name descname"><span class="pre">plot_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">yt.data_objects.selection_objects.data_selection_objects.YTSelectionContainer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'planet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#YtFLEKSData.plot_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.YtFLEKSData.plot_particles" title="Link to this definition"></a></dt>
<dd><p>Plot the particle position of particles inside a box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_field</strong> (<em>x_field &amp;</em>) – str
The x- y- axes, from “p_x”, “p_y”, “p_z”.</p></li>
<li><p><strong>z_field</strong> – str
color variable, usually the particle weight “p_w”.</p></li>
<li><p><strong>region</strong> – YTSelectionContainer
Spatial region to be selected, such as all_data, box, region, or sphere.</p></li>
<li><p><strong>unit_type</strong> – str
The unit system of the plots. “planet” or “si”.</p></li>
</ul>
</dd>
</dl>
<p>See more at <a class="reference external" href="https://yt-project.org/doc/reference/api/yt.visualization.particle_plots.html#yt.visualization.particle_plots.ParticlePlot">https://yt-project.org/doc/reference/api/yt.visualization.particle_plots.html#yt.visualization.particle_plots.ParticlePlot</a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">plot_particles</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;p_x&quot;</span><span class="p">,</span> <span class="s2">&quot;p_y&quot;</span><span class="p">,</span> <span class="s2">&quot;p_w&quot;</span><span class="p">,</span> <span class="n">unit_type</span><span class="o">=</span><span class="s2">&quot;planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flekspy.extract_phase">
<span class="sig-prename descclassname"><span class="pre">flekspy.</span></span><span class="sig-name descname"><span class="pre">extract_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">yt.visualization.profile_plotter.PhasePlot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/yt/yt.html#extract_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.extract_phase" title="Link to this definition"></a></dt>
<dd><p>Extract phase space distribution from PhasePlot object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pp</strong> (<em>PhasePlot</em>) – YT PhasePlot object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Horizontal, vertical coordinates of the plot, and phase space density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>x, y, f</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flekspy.FLEKSTP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flekspy.</span></span><span class="sig-name descname"><span class="pre">FLEKSTP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iDomain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iSpecies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'planetary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">proton_mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">elementary_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iListStart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iListEnd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that is used to read and plot test particles. Each particle ID consists of
a CPU index, a particle index on each CPU, and a location index.
By default, 7 real numbers saved for each step: time + position + velocity.
Additional field information are also stored if available.</p>
<p>This class is a lazy, iterable container. It avoids loading all data into memory
at once, making it efficient for large datasets. You can access particle
trajectories using standard container operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dirs</strong> (<em>str</em>) – the path to the test particle dataset.</p>
</dd>
</dl>
<p>Examples:
&gt;&gt;&gt; tp = FLEKSTP(“res/run1/PC/test_particles”, iSpecies=1)
&gt;&gt;&gt; len(tp)
10240
&gt;&gt;&gt; trajectory = tp[0]
&gt;&gt;&gt; tp.plot_trajectory(tp.IDs[3])
&gt;&gt;&gt; tp.save_trajectory(tp.IDs[5], format=”csv”)
&gt;&gt;&gt; tp.save_trajectory(tp.IDs[5], format=”parquet”)
&gt;&gt;&gt; ids, pData = tp.read_particles_at_time(0.0, doSave=False)
&gt;&gt;&gt; f = tp.plot_location(pData)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.use_cache">
<span class="sig-name descname"><span class="pre">use_cache</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#flekspy.FLEKSTP.use_cache" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.unit">
<span class="sig-name descname"><span class="pre">unit</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'planetary'</span></em><a class="headerlink" href="#flekspy.FLEKSTP.unit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._trajectory_cache">
<span class="sig-name descname"><span class="pre">_trajectory_cache</span></span><a class="headerlink" href="#flekspy.FLEKSTP._trajectory_cache" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.mass">
<span class="sig-name descname"><span class="pre">mass</span></span><a class="headerlink" href="#flekspy.FLEKSTP.mass" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.charge">
<span class="sig-name descname"><span class="pre">charge</span></span><a class="headerlink" href="#flekspy.FLEKSTP.charge" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.iSpecies">
<span class="sig-name descname"><span class="pre">iSpecies</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#flekspy.FLEKSTP.iSpecies" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.pfiles">
<span class="sig-name descname"><span class="pre">pfiles</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#flekspy.FLEKSTP.pfiles" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.particle_locations">
<span class="sig-name descname"><span class="pre">particle_locations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#flekspy.FLEKSTP.particle_locations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.IDs">
<span class="sig-name descname"><span class="pre">IDs</span></span><a class="headerlink" href="#flekspy.FLEKSTP.IDs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.filetime">
<span class="sig-name descname"><span class="pre">filetime</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#flekspy.FLEKSTP.filetime" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.__repr__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.__len__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.__iter__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.__iter__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.__getitem__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.getIDs">
<span class="sig-name descname"><span class="pre">getIDs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.getIDs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.getIDs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.read_particle_list">
<span class="sig-name descname"><span class="pre">read_particle_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.read_particle_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.read_particle_list" title="Link to this definition"></a></dt>
<dd><p>Read and return a list of the particle IDs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._read_the_first_record">
<span class="sig-name descname"><span class="pre">_read_the_first_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._read_the_first_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._read_the_first_record" title="Link to this definition"></a></dt>
<dd><p>Get the first record stored in one file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.read_particles_at_time">
<span class="sig-name descname"><span class="pre">read_particles_at_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doSave</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.read_particles_at_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.read_particles_at_time" title="Link to this definition"></a></dt>
<dd><p>Get the information of all the particles at a given time.
If doSave, save to a CSV file with the name “particles_t***.csv”.</p>
<p>Note that the time tags in filetime do not include the last saved time.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a numpy array of tuples contains the particle IDs.
pData: a numpy real array with the particle weight, location and velocity.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ids</p>
</dd>
</dl>
<p>Examples:
&gt;&gt;&gt; ids, pData = pt.read_particles_at_time(3700, doSave=True)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.save_trajectory">
<span class="sig-name descname"><span class="pre">save_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shiftTime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaleTime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'csv'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.save_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.save_trajectory" title="Link to this definition"></a></dt>
<dd><p>Save the trajectory of a particle to a file.
:param pID: particle ID.
:param filename: The name of the file to save the trajectory to.</p>
<blockquote>
<div><p>If None, a default name will be generated.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shiftTime</strong> (<em>bool</em>) – If set to True, set the initial time to be 0.</p></li>
<li><p><strong>scaleTime</strong> (<em>bool</em>) – If set to True, scale the time into [0,1] range.</p></li>
<li><p><strong>format</strong> (<em>str</em>) – The output format, either “csv” or “parquet”.</p></li>
</ul>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; tp.save_trajectory((3,15), format=”parquet”)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.save_trajectories">
<span class="sig-name descname"><span class="pre">save_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pIDs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'trajectories.h5'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.save_trajectories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.save_trajectories" title="Link to this definition"></a></dt>
<dd><p>Save the trajectories of multiple particles to a single HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pIDs</strong> – A list of particle IDs to save. This can be a list of tuples
(cpu, id) or a list of integer indices.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – The name of the HDF5 file to save the trajectories to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._get_particle_raw_data">
<span class="sig-name descname"><span class="pre">_get_particle_raw_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._get_particle_raw_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._get_particle_raw_data" title="Link to this definition"></a></dt>
<dd><p>Reads all raw trajectory data for a particle across multiple files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._read_particle_record">
<span class="sig-name descname"><span class="pre">_read_particle_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._read_particle_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._read_particle_record" title="Link to this definition"></a></dt>
<dd><p>Return a specific record of a test particle given its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pID</strong> – particle ID</p></li>
<li><p><strong>index</strong> – The index of the record to be returned.
0: first record.
-1: last record (default).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.read_particle_trajectory">
<span class="sig-name descname"><span class="pre">read_particle_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.LazyFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.read_particle_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.read_particle_trajectory" title="Link to this definition"></a></dt>
<dd><p>Return the trajectory of a test particle as a polars LazyFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.read_initial_condition">
<span class="sig-name descname"><span class="pre">read_initial_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.read_initial_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.read_initial_condition" title="Link to this definition"></a></dt>
<dd><p>Return the initial conditions of a test particle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.read_final_condition">
<span class="sig-name descname"><span class="pre">read_final_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.read_final_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.read_final_condition" title="Link to this definition"></a></dt>
<dd><p>Return the final conditions of a test particle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.select_particles">
<span class="sig-name descname"><span class="pre">select_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_select</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.select_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.select_particles" title="Link to this definition"></a></dt>
<dd><p>Return the test particles whose initial conditions satisfy the requirement
set by the user defined function f_select. The first argument of f_select is the
particle ID, and the second argument is the ID of a particle.</p>
<p>Examples:
&gt;&gt;&gt; from flekspy.tp import Indices
&gt;&gt;&gt; def f_select(tp, pid):
&gt;&gt;&gt;     pData = tp.read_initial_condition(pid)
&gt;&gt;&gt;     inTime = pData[Indices.TIME] &lt; 3601
&gt;&gt;&gt;     inRegion = pData[Indices.X] &gt; 20
&gt;&gt;&gt;     return inTime and inRegion
&gt;&gt;&gt;
&gt;&gt;&gt; pselected = tp.select_particles(f_select)
&gt;&gt;&gt; tp.plot_trajectory(list(pselected.keys())[1])</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_kinetic_energy">
<span class="sig-name descname"><span class="pre">get_kinetic_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_kinetic_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_kinetic_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_kinetic_energy_change_rate">
<span class="sig-name descname"><span class="pre">get_kinetic_energy_change_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt_lazy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.Series</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_kinetic_energy_change_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_kinetic_energy_change_rate" title="Link to this definition"></a></dt>
<dd><p>Calculates the rate of change of kinetic energy in [eV/s].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_pitch_angle">
<span class="sig-name descname"><span class="pre">get_pitch_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_pitch_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_pitch_angle" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._get_pitch_angle_lazy">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_get_pitch_angle_lazy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.Series</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._get_pitch_angle_lazy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._get_pitch_angle_lazy" title="Link to this definition"></a></dt>
<dd><p>Calculates the pitch angle from a LazyFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_pitch_angle_from_v_b">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_pitch_angle_from_v_b</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_pitch_angle_from_v_b"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_pitch_angle_from_v_b" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_first_adiabatic_invariant">
<span class="sig-name descname"><span class="pre">get_first_adiabatic_invariant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt_lazy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.Series</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_first_adiabatic_invariant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_first_adiabatic_invariant" title="Link to this definition"></a></dt>
<dd><p>Calculates the 1st adiabatic invariant of a particle.
The output units depend on the input data’s units:
- “planetary” (e.g., velocity in km/s, B-field in nT): result is in [1e9 J/T].
- “SI” (e.g., velocity in m/s, B-field in T): result is in [J/T].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._calculate_bmag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_calculate_bmag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">polars.LazyFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._calculate_bmag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._calculate_bmag" title="Link to this definition"></a></dt>
<dd><p>Calculates the magnetic field magnitude.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._calculate_curvature">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_calculate_curvature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">polars.LazyFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._calculate_curvature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._calculate_curvature" title="Link to this definition"></a></dt>
<dd><p>Calculates the magnetic field curvature vector and adds it to the DataFrame.
κ = (b ⋅ ∇)b
Depending on the selected units, output curvature may be
- “planetary”: [1/RE]
- “SI”: [1/m]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_ExB_drift">
<span class="sig-name descname"><span class="pre">get_ExB_drift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt_lazy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_ExB_drift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_ExB_drift" title="Link to this definition"></a></dt>
<dd><p>Calculates the convection drift velocity for a particle.
v_exb = E x B / (B^2)
Assuming Earth’s planetary units, output drift velocity in [km/s].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_curvature_drift">
<span class="sig-name descname"><span class="pre">get_curvature_drift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt_lazy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_curvature_drift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_curvature_drift" title="Link to this definition"></a></dt>
<dd><p>Calculates the curvature drift velocity for a particle.
v_c = (m * v_parallel^2 / (q*B^2)) * (B x κ)
Depending on the selected units, output drift velocity may be
- “planetary”: [km/s]
- “SI”: [m/s]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_adiabaticity_parameter">
<span class="sig-name descname"><span class="pre">get_adiabaticity_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt_lazy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.Series</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_adiabaticity_parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_adiabaticity_parameter" title="Link to this definition"></a></dt>
<dd><p>Calculates the adiabaticity parameter, defined as the ratio of the
magnetic field’s radius of curvature to the particle’s gyroradius.
When this parameter is &gt;&gt; 1, the motion is adiabatic.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._calculate_gradient_b_magnitude">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_calculate_gradient_b_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">polars.LazyFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._calculate_gradient_b_magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._calculate_gradient_b_magnitude" title="Link to this definition"></a></dt>
<dd><p>Calculates the gradient of the magnetic field magnitude.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_gradient_drift">
<span class="sig-name descname"><span class="pre">get_gradient_drift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt_lazy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_gradient_drift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_gradient_drift" title="Link to this definition"></a></dt>
<dd><p>Calculates the gradient drift velocity for a particle.
v_g = (μ / (q * B^2)) * (B x ∇|B|)
Depending on the selected units, output drift velocity may be
- “planetary”: [km/s]
- “SI”: [m/s]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_polarization_drift">
<span class="sig-name descname"><span class="pre">get_polarization_drift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt_lazy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.LazyFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_polarization_drift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_polarization_drift" title="Link to this definition"></a></dt>
<dd><p>Calculates the polarization drift velocity for a particle.
v_p = (m / (q * B^2)) * (dE_perp / dt)
Depending on the selected units, output drift velocity may be
- “planetary”: [km/s]
- “SI”: [m/s]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_betatron_acceleration">
<span class="sig-name descname"><span class="pre">get_betatron_acceleration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_betatron_acceleration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_betatron_acceleration" title="Link to this definition"></a></dt>
<dd><p>Calculates the Betatron acceleration term from particle trajectory data.</p>
<p>The calculation follows the formula: dW/dt = μ * (∂B/∂t)
where the partial derivative is found using: ∂B/∂t = dB/dt - v ⋅ ∇B</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pt</strong> – A Polars LazyFrame containing the particle trajectory.
It must include columns for time, velocity (vx, vy, vz),
magnetic field (bx, by, bz), and the magnetic field
gradient tensor (e.g., ‘dbxdx’, ‘dbydx’, etc.).</p></li>
<li><p><strong>mu</strong> – A Polars Series containing the magnetic moment (first adiabatic invariant)
of the particle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Polars LazyFrame with added intermediate columns and the
final ‘dW_betatron’ column representing the rate of energy change in [eV/s].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_energy_change_guiding_center">
<span class="sig-name descname"><span class="pre">get_energy_change_guiding_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_energy_change_guiding_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_energy_change_guiding_center" title="Link to this definition"></a></dt>
<dd><p>Computes the change of energy of a single particle based on the guiding center theory.</p>
<p>The formula is given by:
dW/dt = q*E_parallel*v_parallel + mu*(∂B/∂t + u_E.∇B) + m*v_parallel^2*(u_E.κ)</p>
<p>where W is the particle energy, B is the magnetic field magnitude,
u_E is the E cross B drift, and κ is the magnetic field curvature.
The first term on the right hand side is the parallel acceleration,
the second term is the Betatron acceleration, and the third term
is one type of Fermi acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pID</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The particle ID (cpu, id).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Polars DataFrame with the time, the three energy change components,
and the total, in [eV/s].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.integrate_drift_accelerations">
<span class="sig-name descname"><span class="pre">integrate_drift_accelerations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.integrate_drift_accelerations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.integrate_drift_accelerations" title="Link to this definition"></a></dt>
<dd><p>Compute plasma drift velocities and the associated rate of energy change in [eV/s].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.analyze_drifts">
<span class="sig-name descname"><span class="pre">analyze_drifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switchYZ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.analyze_drifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.analyze_drifts" title="Link to this definition"></a></dt>
<dd><p>Compute plasma drift velocities and the associated rate of energy change in [eV/s].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.analyze_drifts_energy_change">
<span class="sig-name descname"><span class="pre">analyze_drifts_energy_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.analyze_drifts_energy_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.analyze_drifts_energy_change" title="Link to this definition"></a></dt>
<dd><p>Analyzes and plots the energy changes for each term in the guiding center
approximation.</p>
<p>This method computes the parallel, Betatron, and Fermi accelerations using
<cite>get_energy_change_guiding_center</cite>. It also calculates the total kinetic
energy change and treats the difference between the kinetic energy change
and the sum of the guiding center terms (dW_total) as the non-adiabatic term.</p>
<p>The method generates a plot with four subplots:
1. dW_parallel: Energy change due to parallel electric fields.
2. dW_betatron: Energy change due to the Betatron effect.
3. dW_fermi: Energy change due to Fermi acceleration.
4. dW_total and Non-adiabatic term: The sum of the above terms compared</p>
<blockquote>
<div><p>with the non-adiabatic heating component.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pID</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The particle ID (cpu, id).</p></li>
<li><p><strong>outname</strong> (<em>str</em><em>, </em><em>optional</em>) – If provided, the plot is saved to this
filename instead of being shown. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.analyze_drift">
<span class="sig-name descname"><span class="pre">analyze_drift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.analyze_drift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.analyze_drift" title="Link to this definition"></a></dt>
<dd><p>Analyzes a specific drift for a particle, plotting its velocity, the
electric field, the energy change rate, and the integrated energy change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pID</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The particle ID (cpu, id).</p></li>
<li><p><strong>drift_type</strong> (<em>str</em>) – The type of drift to analyze. Supported options are:
‘ExB’, ‘gradient’, ‘curvature’, ‘polarization’.</p></li>
<li><p><strong>outname</strong> (<em>str</em><em>, </em><em>optional</em>) – If provided, the plot is saved to this
filename instead of being shown. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.plot_work_energy_verification">
<span class="sig-name descname"><span class="pre">plot_work_energy_verification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.plot_work_energy_verification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.plot_work_energy_verification" title="Link to this definition"></a></dt>
<dd><p>Verifies the work-energy theorem for a particle by plotting the rate of
change of kinetic energy against the work rate done by the electric field.
It also plots the integrated change in kinetic energy versus the total
work done.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pID</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The particle ID (cpu, id).</p></li>
<li><p><strong>outname</strong> (<em>str</em><em>, </em><em>optional</em>) – If provided, the plot is saved to this
filename. Defaults to None (displays plot).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.find_shock_crossing_time">
<span class="sig-name descname"><span class="pre">find_shock_crossing_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_threshold_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.find_shock_crossing_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.find_shock_crossing_time" title="Link to this definition"></a></dt>
<dd><p>Finds the shock crossing time for a single particle.</p>
<p>The shock is identified by finding the first rate of change in the
magnetic field magnitude that exceeds a threshold, which signifies a
rapid transition between the upstream and downstream regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pid</strong> – particle index.</p></li>
<li><p><strong>b_threshold_factor</strong> (<em>float</em>) – A multiplier for the standard deviation of
the B-field derivative. A larger value makes
the detection less sensitive to minor
fluctuations. Defaults to 2.5.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints diagnostic information. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The time of the shock crossing in seconds. Returns None if</dt><dd><p>no significant crossing is detected based on the criteria.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.get_shock_up_down_states">
<span class="sig-name descname"><span class="pre">get_shock_up_down_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_t_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_t_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_threshold_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.get_shock_up_down_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.get_shock_up_down_states" title="Link to this definition"></a></dt>
<dd><p>Analyzes particles to find their state upstream and downstream of a shock.</p>
<p>This function iterates through a list of particle IDs. For each particle, it
first identifies the shock crossing time. It then calculates specific upstream
and downstream time points based on this crossing. Finally, it interpolates
the particle’s full state (position, velocity, fields) at these two points
and collects the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pids</strong> (<em>list</em>) – A list of particle IDs (e.g., [(0, 1), (0, 2), …]) to process.</p></li>
<li><p><strong>delta_t_up</strong> (<em>float</em>) – The time in seconds <em>before</em> the shock crossing to define
the upstream point. Defaults to 20.0.</p></li>
<li><p><strong>delta_t_down</strong> (<em>float</em>) – The time in seconds <em>after</em> the shock crossing to define
the downstream point. Defaults to 40.0.</p></li>
<li><p><strong>b_threshold_factor</strong> (<em>float</em>) – The sensitivity factor for shock detection, passed to
<cite>find_shock_crossing_time</cite>. Defaults to 2.5.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints progress and individual shock detection times.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing two Polars DataFrames:</dt><dd><ul class="simple">
<li><p>The first DataFrame contains the states of all valid particles at their
respective upstream times.</p></li>
<li><p>The second DataFrame contains the states of all valid particles at their
respective downstream times.</p></li>
</ul>
</dd>
</dl>
<p>Each DataFrame includes the original particle ID (<cite>pid_rank</cite>, <cite>pid_idx</cite>), the
shock crossing time (<cite>t_cross</cite>), and the interpolated physical quantities.
Returns (None, None) if no particles with a valid shock crossing are found.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[pl.DataFrame, pl.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._get_HT_frame">
<span class="sig-name descname"><span class="pre">_get_HT_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">upstream_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._get_HT_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._get_HT_frame" title="Link to this definition"></a></dt>
<dd><p>Finds the de Hoffmann-Teller frame velocity and the shock normal vector
using the method from Sonnerup et al. [2006], which minimizes the
residual electric field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>upstream_df</strong> (<em>pl.DataFrame</em>) – DataFrame with upstream particle states.</p></li>
<li><p><strong>downstream_df</strong> (<em>pl.DataFrame</em>) – DataFrame with downstream particle states.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>V_HT (np.ndarray | None): The de Hoffmann-Teller velocity vector
in [km/s] if successful, otherwise None.</p></li>
<li><p>shock_normal (np.ndarray | None): The estimated shock normal
vector if successful, otherwise None.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray | None, np.ndarray | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.analyze_in_HT_frame">
<span class="sig-name descname"><span class="pre">analyze_in_HT_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.analyze_in_HT_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.analyze_in_HT_frame" title="Link to this definition"></a></dt>
<dd><p>Analyzes a particle’s trajectory in the de Hoffmann-Teller (HT) frame.</p>
<p>This method performs the following steps:
1. Finds the shock crossing and determines the upstream and downstream states.
2. Calculates the de Hoffmann-Teller velocity (V_HT) and the shock normal.
3. Transforms the particle’s velocity and the electric/magnetic fields</p>
<blockquote>
<div><p>into the HT frame.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>In this frame, the energy gain is a direct measure of non-ideal
acceleration. It calculates and plots this energy gain.</p></li>
<li><p>Generates a summary plot of the analysis.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pID</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The particle ID (cpu, id) to analyze.</p></li>
<li><p><strong>outname</strong> (<em>str</em><em>, </em><em>optional</em>) – If provided, the plot is saved to this
filename. Defaults to None (displays plot).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints diagnostic information.
Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.plot_trajectory">
<span class="sig-name descname"><span class="pre">plot_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fscaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shock_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'quick'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switchYZ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitYZ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.plot_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.plot_trajectory" title="Link to this definition"></a></dt>
<dd><p>Plots the trajectory and velocities of the particle pID.</p>
<p>Example:
&gt;&gt;&gt; tp.plot_trajectory((3,15))</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.plot_location">
<span class="sig-name descname"><span class="pre">plot_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pData</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.plot_location"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.plot_location" title="Link to this definition"></a></dt>
<dd><p>Plot the location of particles pData.</p>
<p>Examples:
&gt;&gt;&gt; ids, pData = tp.read_particles_at_time(3700, doSave=True)
&gt;&gt;&gt; f = tp.plot_location(pData)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._calculate_true_gc_trajectory">
<span class="sig-name descname"><span class="pre">_calculate_true_gc_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_gyro_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.DataFrame</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._calculate_true_gc_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._calculate_true_gc_trajectory" title="Link to this definition"></a></dt>
<dd><p>Calculates the ‘true’ guiding center trajectory by smoothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._integrate_velocity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_integrate_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_pos_series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.Series</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.Series</span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._integrate_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._integrate_velocity" title="Link to this definition"></a></dt>
<dd><p>Integrates a velocity series using the trapezoidal rule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._calculate_predicted_gc_trajectory">
<span class="sig-name descname"><span class="pre">_calculate_predicted_gc_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">polars.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">polars.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">polars.Series</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._calculate_predicted_gc_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._calculate_predicted_gc_trajectory" title="Link to this definition"></a></dt>
<dd><p>Calculates the predicted guiding center trajectory from theory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP._plot_gc_verification">
<span class="sig-name descname"><span class="pre">_plot_gc_verification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_gc_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">polars.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_gc_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">polars.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">polars.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">polars.Series</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP._plot_gc_verification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP._plot_gc_verification" title="Link to this definition"></a></dt>
<dd><p>Plots the verification results.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.FLEKSTP.verify_guiding_center_model">
<span class="sig-name descname"><span class="pre">verify_guiding_center_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_gyro_periods</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/tp/test_particles.html#FLEKSTP.verify_guiding_center_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.FLEKSTP.verify_guiding_center_model" title="Link to this definition"></a></dt>
<dd><p>Verifies the guiding center model by comparing it against the full
particle trajectory.</p>
<p>This method performs the following steps:
1. Calculates a “true” guiding center trajectory by applying a low-pass</p>
<blockquote>
<div><p>filter (moving average) to the full particle trajectory, smoothing
out the gyromotion.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Calculates a “predicted” guiding center trajectory by numerically
integrating the guiding center velocity, which is the sum of the
parallel velocity and all perpendicular drift velocities (E x B,
gradient, curvature, and polarization).</p></li>
<li><p>Generates a plot comparing the full trajectory, the “true” GC
trajectory, and the “predicted” GC trajectory for each coordinate (X, Y, Z).</p></li>
</ol>
<p>A close overlap between the “true” and “predicted” trajectories
validates the guiding center approximation and the drift calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pID</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The ID of the particle to analyze.</p></li>
<li><p><strong>smoothing_gyro_periods</strong> (<em>float</em>) – The size of the moving average window
in units of gyro-periods. Defaults to 1.0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flekspy.</span></span><span class="sig-name descname"><span class="pre">AMReXParticleData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy/amrex.html#AMReXParticleData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.AMReXParticleData" title="Link to this definition"></a></dt>
<dd><p>This class provides an interface to the particle data in a plotfile.
Data is loaded lazily upon first access to <cite>idata</cite> or <cite>rdata</cite>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.output_dir">
<span class="sig-name descname"><span class="pre">output_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#flekspy.AMReXParticleData.output_dir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.ptype">
<span class="sig-name descname"><span class="pre">ptype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#flekspy.AMReXParticleData.ptype" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData._idata">
<span class="sig-name descname"><span class="pre">_idata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flekspy.AMReXParticleData._idata" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData._rdata">
<span class="sig-name descname"><span class="pre">_rdata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flekspy.AMReXParticleData._rdata" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.level_boxes">
<span class="sig-name descname"><span class="pre">level_boxes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#flekspy.AMReXParticleData.level_boxes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.header">
<span class="sig-name descname"><span class="pre">header</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="amrex/index.html#flekspy.amrex.AMReXParticleHeader" title="flekspy.amrex.AMReXParticleHeader"><span class="pre">AMReXParticleHeader</span></a></em><a class="headerlink" href="#flekspy.AMReXParticleData.header" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#flekspy.AMReXParticleData.dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.time">
<span class="sig-name descname"><span class="pre">time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#flekspy.AMReXParticleData.time" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.left_edge">
<span class="sig-name descname"><span class="pre">left_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#flekspy.AMReXParticleData.left_edge" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.right_edge">
<span class="sig-name descname"><span class="pre">right_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#flekspy.AMReXParticleData.right_edge" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.domain_dimensions">
<span class="sig-name descname"><span class="pre">domain_dimensions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#flekspy.AMReXParticleData.domain_dimensions" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData._load_data">
<span class="sig-name descname"><span class="pre">_load_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/amrex.html#AMReXParticleData._load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.AMReXParticleData._load_data" title="Link to this definition"></a></dt>
<dd><p>Loads the particle data from disk if it has not been loaded yet.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.idata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">idata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#flekspy.AMReXParticleData.idata" title="Link to this definition"></a></dt>
<dd><p>Lazily loads and returns the integer particle data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.rdata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rdata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#flekspy.AMReXParticleData.rdata" title="Link to this definition"></a></dt>
<dd><p>Lazily loads and returns the real particle data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData._parse_main_header">
<span class="sig-name descname"><span class="pre">_parse_main_header</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/amrex.html#AMReXParticleData._parse_main_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.AMReXParticleData._parse_main_header" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData._parse_particle_h_files">
<span class="sig-name descname"><span class="pre">_parse_particle_h_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/amrex.html#AMReXParticleData._parse_particle_h_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.AMReXParticleData._parse_particle_h_files" title="Link to this definition"></a></dt>
<dd><p>Parses the Particle_H files to get the box arrays for each level.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/flekspy/amrex.html#AMReXParticleData.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.AMReXParticleData.__repr__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.select_particles_in_region">
<span class="sig-name descname"><span class="pre">select_particles_in_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../../_modules/flekspy/amrex.html#AMReXParticleData.select_particles_in_region"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.AMReXParticleData.select_particles_in_region" title="Link to this definition"></a></dt>
<dd><p>Selectively loads real component data for particles that fall within a
specified rectangular region.</p>
<p>This method first converts the physical range into an index-based range,
then identifies which grid files intersect with that range, and finally
reads only the necessary data. This avoids loading the entire dataset
into memory. Integer data is skipped for efficiency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_range</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A tuple (min, max) for the x-axis boundary.</p></li>
<li><p><strong>y_range</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A tuple (min, max) for the y-axis boundary.</p></li>
<li><p><strong>z_range</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A tuple (min, max) for the z-axis boundary.
For 2D data, this is ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A numpy array containing the real data for the</dt><dd><p>selected particles.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flekspy.AMReXParticleData.plot_phase">
<span class="sig-name descname"><span class="pre">plot_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_variable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_variable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">imshow_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.figure.Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">matplotlib.axes.Axes</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/flekspy/amrex.html#AMReXParticleData.plot_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.AMReXParticleData.plot_phase" title="Link to this definition"></a></dt>
<dd><p>Plots the 2D phase space distribution for any two selected variables.</p>
<p>This function creates a 2D weighted histogram to visualize the particle
density. If a ‘weight’ component is present in the data, it will be
used for the histogram weighting. Otherwise, a standard (unweighted)
histogram is generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_variable</strong> (<em>str</em>) – The name of the variable for the x-axis.</p></li>
<li><p><strong>y_variable</strong> (<em>str</em>) – The name of the variable for the y-axis.</p></li>
<li><p><strong>bins</strong> (<em>int</em><em> or </em><em>tuple</em><em>, </em><em>optional</em>) – The number of bins. This can be a
single integer for the same number of
bins in each dimension, or a two-element
tuple for different numbers of bins in the
x and y dimension, respectively.
Defaults to 100.</p></li>
<li><p><strong>hist_range</strong> (<em>list</em><em> of </em><em>lists</em><em>, </em><em>optional</em>) – The leftmost and rightmost edges of the
bins along each dimension. It should be
in the format [[xmin, xmax], [ymin, ymax]].
Defaults to None.</p></li>
<li><p><strong>x_range</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A tuple (min, max) for the x-axis boundary.</p></li>
<li><p><strong>y_range</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A tuple (min, max) for the y-axis boundary.</p></li>
<li><p><strong>z_range</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A tuple (min, max) for the z-axis boundary.
For 2D data, this is ignored.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the histogram is normalized to
form a probability density. Defaults to False.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – The title for the plot. Defaults to “Phase Space Distribution”.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – The label for the x-axis. Defaults to <cite>x_variable</cite>.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – The label for the y-axis. Defaults to <cite>y_variable</cite>.</p></li>
<li><p><strong>**imshow_kwargs</strong> – Additional keyword arguments to be passed to <cite>ax.imshow()</cite>.
This can be used to control colormaps (<cite>cmap</cite>), normalization (<cite>norm</cite>), etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the matplotlib figure and axes objects (<cite>fig</cite>, <cite>ax</cite>).</dt><dd><p>This allows for further customization of the plot after its creation.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flekspy.load">
<span class="sig-prename descclassname"><span class="pre">flekspy.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iDomain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iSpecies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iFile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">readFieldData</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_yt_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/flekspy.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flekspy.load" title="Link to this definition"></a></dt>
<dd><p>Load FLEKS data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Input file name pattern.</p></li>
<li><p><strong>iDomain</strong> (<em>int</em><em>, </em><em>optional</em>) – Test particle domain index. Defaults to 0.</p></li>
<li><p><strong>iSpecies</strong> (<em>int</em><em>, </em><em>optional</em>) – Test particle species index. Defaults to 0.</p></li>
<li><p><strong>iFile</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the file to load if the pattern
matches multiple files. Defaults to 0.</p></li>
<li><p><strong>readFieldData</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to read field data for test particles. Defaults to False.</p></li>
<li><p><strong>use_yt_loader</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, forces the use of the yt loader for AMReX data. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>xarray.Dataset, YtFLEKSData, or FLEKSTP</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>FLEKS data</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="amrex/index.html" class="btn btn-neutral float-right" title="flekspy.amrex" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Yuxi Chen, Hongyang Zhou.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>